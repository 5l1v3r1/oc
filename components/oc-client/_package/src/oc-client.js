"use strict";var oc=oc||{};!function(e,r,n){oc.conf=oc.conf||{},oc.cmd=oc.cmd||[];var o,t="https://cdnjs.cloudflare.com/ajax/libs/",c=t+"jquery-ajaxtransport-xdomainrequest/1.0.3/jquery.xdomainrequest.min.js",a=t+"handlebars.js/3.0.1/handlebars.runtime.js",i=t+"jade/1.9.2/runtime.min.js",d=t+"jquery/1.11.2/jquery.min.js",u=oc.conf.retryInterval||5e3,f=oc.conf.retryLimit||30,l=oc.conf.retrySendNumber||!0,s=oc.conf.pollingInterval||500,m=oc.conf.tag||"oc-component",p="Href parameter missing",v="Failed to load {0} component {1} times. Giving up".replace("{1}",f),h="Error getting compiled view: {0}",y="Error rendering component: {0}, error: {1}",g="Failed to retrieve the component. Retrying in {0} seconds...".replace("{0}",u/1e3),j='Error loading component: view engine "{0}" not supported',b="Loading...",q="Component '{0}' correctly rendered",x="Unrendered component found. Trying to retrieve it...",w=oc.conf.debug||!1,C=function(){},E=n.navigator.userAgent,I=!!E.match(/MSIE 8/),M=!!E.match(/MSIE 9/),O=!1,U=!1,L={error:function(e){return console.log(e)},info:function(e){return w?console.log(e):!1}},k={},H=function(e,r,n){return void 0===k[e]&&(k[e]=f),k[e]<=0?n():(setTimeout(function(){r(f-k[e]+1)},u),void k[e]--)},_=function(e,r){if(e&&r){var n=o.param(r);return e.indexOf("?")>-1?e+"&"+n:e+"?"+n}return e};oc.require=function(r,o,t){"function"==typeof o&&(t=o,o=r,r=void 0),"string"==typeof r&&(r=[r]);var c=function(){var e=n;if("undefined"==typeof r)return!0;for(var o=0;o<r.length;o++)if(e=e[r[o]],!e)return!0;return!1},a=function(){var e=n;if("undefined"==typeof r)return void 0;for(var o=0;o<r.length;o++)if(e=e[r[o]],!e)return void 0;return e};c()?e.load(o,function(){t(a())}):t(a())};var N=function(e,r,n){var o=Math.floor(9999999999*Math.random());e.html(r.html),e.attr("id",o),e.attr("data-rendered",!0),e.attr("data-rendering",!1),e.attr("data-version",r.version),r.key&&e.attr("data-hash",r.key),n()};oc.build=function(e){if(!e.baseUrl)throw"baseUrl parameter is required";if(!e.name)throw"name parameter is required";var r=function(e){return e=e||"","/"!==e.slice(-1)&&(e+="/"),e},n=r(e.baseUrl)+r(e.name);if(e.version&&(n+=r(e.version)),e.parameters){n+="?";for(var o in e.parameters)e.parameters.hasOwnProperty(o)&&(n+=o+"="+e.parameters[o]+"&");n=n.slice(0,-1)}return I?'<div data-oc-component="true" href="'+n+'"></div>':"<"+m+' href="'+n+'"></'+m+">"},oc.ready=function(e){if(O)return e();if(U)oc.cmd.push(e);else{U=!0;var r=function(e){!I&&!M||o.IE_POLYFILL_LOADED?e():oc.require(c,e)},n=function(){O=!0,U=!1,e();for(var r=0;r<oc.cmd.length;r++)oc.cmd[r](oc);oc.cmd={push:function(e){e(oc)}}};oc.require("jQuery",d,function(e){o=e,r(n)})}},oc.render=function(e,r,n){oc.ready(function(){e.type.match(/jade|handlebars/g)?oc.require(["oc","components",e.key],e.src,function(o){o?"handlebars"===e.type?oc.require("Handlebars",a,function(e){var t=e.template(o,[]);n(null,t(r))}):"jade"===e.type&&oc.require("jade",i,function(e){n(null,o(r))}):n(h.replace("{0}",e.src))}):n(j.replace("{0}",e.type))})},oc.renderNestedComponent=function(e,r){oc.ready(function(){var n=e.attr("data-rendering"),o=e.attr("data-rendered"),t="boolean"==typeof n?n:"true"===n,c="boolean"==typeof o?o:"true"===o;t||c?setTimeout(r,s):(L.info(x),e.attr("data-rendering",!0),e.html('<div class="oc-loading">'+b+"</div>"),oc.renderByHref(e.attr("href"),function(n,o){return n||!o?(L.error(n),r()):void N(e,o,r)}))})},oc.renderByHref=function(e,r,n){var t=n,c=r;"function"==typeof r&&(t=r,c=0),oc.ready(function(){if(""===e)return t(y.replace("{1}",p));var r=e;l&&(r=_(r,{__oc_Retry:c})),o.ajax({url:r,headers:{Accept:"application/vnd.oc.unrendered+json"},contentType:"text/plain",crossDomain:!0,async:!0,success:function(e){if("pre-rendered"===e.renderMode||"unrendered"===e.renderMode)oc.render(e.template,e.data,function(r,n){return r?t(y.replace("{0}",e.href).replace("{1}",r)):(L.info(q.replace("{0}",e.template.src)),void t(null,{html:n,key:e.template.key,version:e.version}))});else if("rendered"===e.renderMode){if(L.info(q.replace("{0}",e.href)),0===e.html.indexOf("<"+m)){var r=e.html.slice(e.html.indexOf(">")+1),n=r.slice(0,r.lastIndexOf("<"));e.html=n}t(null,{html:e.html,version:e.version})}},error:function(){L.error(g),H(e,function(r){oc.renderByHref(e,r,t)},function(){t(v.replace("{0}",e))})}})})},oc.renderUnloadedComponents=function(){oc.ready(function(){var e=I?"div[data-oc-component=true]":m,r=o(e+"[data-rendered!=true]"),n=function(e,r){oc.renderNestedComponent(o(e[r]),function(){r++,r<e.length?n(e,r):oc.renderUnloadedComponents()})};r.length>0&&n(r,0)})},oc.load=function(e,r,n){oc.ready(function(){if("function"!=typeof n&&(n=C),o(e)){o(e).html("<"+m+' href="'+r+'" />');var t=o(m,e);oc.renderNestedComponent(t,function(){n(t)})}})},oc.ready(oc.renderUnloadedComponents)}(head,document,window);