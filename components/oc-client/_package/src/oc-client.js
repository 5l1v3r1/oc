"use strict";var oc=oc||{};!function(e,n,r){oc.conf=oc.conf||{},oc.cmd=oc.cmd||[],oc.renderedComponents=oc.renderedComponents||{};var o,t="https://cdnjs.cloudflare.com/ajax/libs/",c=t+"jquery-ajaxtransport-xdomainrequest/1.0.3/jquery.xdomainrequest.min.js",a=t+"handlebars.js/3.0.1/handlebars.runtime.js",i=t+"jade/1.9.2/runtime.min.js",d=t+"jquery/1.11.2/jquery.min.js",u=oc.conf.retryInterval||5e3,f=oc.conf.retryLimit||30,s=oc.conf.retrySendNumber||!0,l=oc.conf.pollingInterval||500,m=oc.conf.tag||"oc-component",p="baseUrl parameter is required",v="Href parameter missing",y="name parameter is required",h="Failed to load {0} component {1} times. Giving up".replace("{1}",f),g="Error getting compiled view: {0}",j="Error rendering component: {0}, error: {1}",b="Failed to retrieve the component. Retrying in {0} seconds...".replace("{0}",u/1e3),q='Error loading component: view engine "{0}" not supported',x="Loading...",C="Component '{0}' correctly rendered",w="Unrendered component found. Trying to retrieve it...",E=oc.conf.debug||!1,I=function(){},M=r.navigator.userAgent,O=!!M.match(/MSIE 8/),U=!!M.match(/MSIE 9/),L=!1,k=!1,H={},_={error:function(e){return console.log(e)},info:function(e){return E?console.log(e):!1}},N=function(e,n,r){return void 0===H[e]&&(H[e]=f),H[e]<=0?r():(setTimeout(function(){n(f-H[e]+1)},u),void H[e]--)},T=function(e,n){if(e&&n){var r=o.param(n);return e.indexOf("?")>-1?e+"&"+r:e+"?"+r}return e};oc.require=function(n,o,t){"function"==typeof o&&(t=o,o=n,n=void 0),"string"==typeof n&&(n=[n]);var c=function(){var e=r;if("undefined"==typeof n)return!0;for(var o=0;o<n.length;o++)if(e=e[n[o]],!e)return!0;return!1},a=function(){var e=r;if("undefined"==typeof n)return void 0;for(var o=0;o<n.length;o++)if(e=e[n[o]],!e)return void 0;return e};c()?e.load(o,function(){t(a())}):t(a())};var A=function(e,n,r){n.id=Math.floor(9999999999*Math.random()),e.html(n.html),e.attr("id",n.id),e.attr("data-rendered",!0),e.attr("data-rendering",!1),e.attr("data-version",n.version),n.key&&e.attr("data-hash",n.key),n.name&&(e.attr("data-name",n.name),oc.renderedComponents[n.name]=n.version,oc.events.fire("oc:rendered",n)),r()};oc.build=function(e){if(!e.baseUrl)throw p;if(!e.name)throw y;var n=function(e){return e=e||"","/"!==e.slice(-1)&&(e+="/"),e},r=n(e.baseUrl)+n(e.name);if(e.version&&(r+=n(e.version)),e.parameters){r+="?";for(var o in e.parameters)e.parameters.hasOwnProperty(o)&&(r+=o+"="+e.parameters[o]+"&");r=r.slice(0,-1)}return O?'<div data-oc-component="true" href="'+r+'"></div>':"<"+m+' href="'+r+'"></'+m+">"},oc.events={},oc.ready=function(e){if(L)return e();if(k)oc.cmd.push(e);else{k=!0;var n=function(e){!O&&!U||o.IE_POLYFILL_LOADED?e():oc.require(c,e)},r=function(){L=!0,k=!1,oc.events=function(){var e=o({});return{fire:function(n,r){return e.trigger(n,r)},on:function(n,r){return e.on(n,r||I)},reset:function(){return e.off()}}}(),e(),oc.events.fire("oc:ready",oc);for(var n=0;n<oc.cmd.length;n++)oc.cmd[n](oc);oc.cmd={push:function(e){e(oc)}}};oc.require("jQuery",d,function(e){o=e,n(r)})}},oc.render=function(e,n,r){oc.ready(function(){e.type.match(/jade|handlebars/g)?oc.require(["oc","components",e.key],e.src,function(o){o?"handlebars"===e.type?oc.require("Handlebars",a,function(e){var t=e.template(o,[]);r(null,t(n))}):"jade"===e.type&&oc.require("jade",i,function(e){r(null,o(n))}):r(g.replace("{0}",e.src))}):r(q.replace("{0}",e.type))})},oc.renderNestedComponent=function(e,n){oc.ready(function(){var r=e.attr("data-rendering"),o=e.attr("data-rendered"),t="boolean"==typeof r?r:"true"===r,c="boolean"==typeof o?o:"true"===o;t||c?setTimeout(n,l):(_.info(w),e.attr("data-rendering",!0),e.html('<div class="oc-loading">'+x+"</div>"),oc.renderByHref(e.attr("href"),function(r,o){return r||!o?(_.error(r),n()):void A(e,o,n)}))})},oc.renderByHref=function(e,n,r){var t=r,c=n;"function"==typeof n&&(t=n,c=0),oc.ready(function(){if(""===e)return t(j.replace("{1}",v));var n=e;s&&(n=T(n,{__oc_Retry:c})),o.ajax({url:n,headers:{Accept:"application/vnd.oc.unrendered+json"},contentType:"text/plain",crossDomain:!0,async:!0,success:function(e){if("pre-rendered"===e.renderMode||"unrendered"===e.renderMode)oc.render(e.template,e.data,function(n,r){return n?t(j.replace("{0}",e.href).replace("{1}",n)):(_.info(C.replace("{0}",e.template.src)),void t(null,{html:r,key:e.template.key,version:e.version,name:e.name}))});else if("rendered"===e.renderMode){if(_.info(C.replace("{0}",e.href)),0===e.html.indexOf("<"+m)){var n=e.html.slice(e.html.indexOf(">")+1),r=n.slice(0,n.lastIndexOf("<"));e.html=r}t(null,{html:e.html,version:e.version,name:e.name})}},error:function(){_.error(b),N(e,function(n){oc.renderByHref(e,n,t)},function(){t(h.replace("{0}",e))})}})})},oc.renderUnloadedComponents=function(){oc.ready(function(){var e=O?"div[data-oc-component=true]":m,n=o(e+"[data-rendered!=true]"),r=n.length,t=function(e){r--,r||oc.renderUnloadedComponents()};if(r>0)for(var c=0;c<n.length;c++)oc.renderNestedComponent(o(n[c]),t)})},oc.load=function(e,n,r){oc.ready(function(){if("function"!=typeof r&&(r=I),o(e)){o(e).html("<"+m+' href="'+n+'" />');var t=o(m,e);oc.renderNestedComponent(t,function(){r(t)})}})},oc.ready(oc.renderUnloadedComponents)}(head,document,window);